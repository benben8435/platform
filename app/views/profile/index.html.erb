<p id="notice"><%= notice %></p>
<h1>用户管理</h1>
<table>
  <thead>
    <tr>
      <th>电子邮箱</th>
      <th>名字</th>
      <th>用户权限</th>
      <th>最近登录时间</th>
      <% if change_authority? %>
      <th></th>
      <% end %>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @user_list.each do |user| %>
      <tr>
        <td><%= user.email %></td>
        <td><%= user.name %></td>
        <td><%= show_authority user.authority %></td>
        <td><%= user.last_sign_in_at.in_time_zone("Central Time (US & Canada)") %></td>
        <td><% if change_authority? %>
          <% if user.authority == 0 %>
          <%= button_to 'Upgrade to Admin', {action: :upgrade, user: user, 
              upgrade: :true}, method: :put %>
          <% end %>
          <% if user.authority == 1 %>
          <%= button_to 'Downgrade to User', {action: :upgrade, user: user, 
              upgrade: :false}, method: :put %>
          <% end %>
        <% end %>
        </td>
        <td><%= button_to '删除用户', profile_destroy_path(id: user), method: :delete, 
        :disabled => delete_authorized(user), data: { confirm: '确定删除嘛？' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>